---
import Layout from '../../layouts/Layout.astro';
import EnemyManager from '../../components/EnemyManager.astro';
import LanguageSwitcher from '../../components/LanguageSwitcher.astro';
import { useTranslations } from '../../i18n/utils';
import type { Lang } from '../../i18n/translations';

export function getStaticPaths() {
  return [
    { params: { lang: undefined } },
    { params: { lang: 'en' } },
  ];
}

const lang = (Astro.params.lang || 'es') as Lang;
const t = useTranslations(lang);

const jsTranslations = {
  'type.normal': t['type.normal'],
  'type.elite': t['type.elite'],
  'type.boss': t['type.boss'],
  'type.objective': t['type.objective'],
  'em.expand': t['em.expand'],
  'em.collapse': t['em.collapse'],
  'js.confirmClear': t['js.confirmClear'],
};
---

<Layout
  title={t['page.title']}
  lang={lang}
  description={t['meta.description']}
  ogTitle={t['meta.og.title']}
  siteName={t['meta.og.siteName']}
  keywords={t['meta.keywords']}
>
  <div class="app-layout">
    <!-- Decorative Top Border -->
    <div class="decorative-border top-border">
      <div class="border-ornament left"></div>
      <div class="border-line"></div>
      <div class="border-ornament right"></div>
    </div>

    <!-- Header -->
    <header class="header">
      <div class="header-inner container">
        <!-- Logo & Brand -->
        <div class="brand">
          <div class="brand-emblem">
            <div class="emblem-inner">
              <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" class="emblem-icon">
                <path d="M20 4L4 12L20 20L36 12L20 4Z" fill="url(#gold-gradient)" opacity="0.9"/>
                <path d="M4 28L20 36L36 28" stroke="url(#gold-gradient)" stroke-width="2" stroke-linecap="round"/>
                <path d="M4 20L20 28L36 20" stroke="url(#gold-gradient)" stroke-width="2" stroke-linecap="round"/>
                <circle cx="20" cy="20" r="4" fill="url(#gold-gradient)"/>
                <defs>
                  <linearGradient id="gold-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="#f3d98b"/>
                    <stop offset="50%" stop-color="#d4a438"/>
                    <stop offset="100%" stop-color="#9a6a21"/>
                  </linearGradient>
                </defs>
              </svg>
            </div>
            <div class="emblem-glow"></div>
          </div>
          <div class="brand-text">
            <h1 class="brand-title">Gloomhaven</h1>
            <div class="brand-divider">
              <span class="divider-line"></span>
              <span class="divider-gem">‚óÜ</span>
              <span class="divider-line"></span>
            </div>
            <p class="brand-tagline">{t['header.tagline']}</p>
          </div>
        </div>

        <!-- Header Actions -->
        <div class="header-actions">
          <LanguageSwitcher lang={lang} />
          <button class="action-btn" id="helpBtn" aria-label={t['header.help']}>
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
              <path d="M9 9a3 3 0 115 2.83c-.5.29-1 .88-1 1.67v.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              <circle cx="12" cy="17" r="1" fill="currentColor"/>
            </svg>
          </button>
          <button class="action-btn" id="settingsBtn" aria-label={t['header.settings']}>
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 15a3 3 0 100-6 3 3 0 000 6z" stroke="currentColor" stroke-width="2"/>
              <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z" stroke="currentColor" stroke-width="2"/>
            </svg>
          </button>
        </div>

        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label={t['header.menu']}>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
          <span class="hamburger-line"></span>
        </button>
      </div>
    </header>

    <!-- Mobile Navigation Drawer -->
    <div class="mobile-nav-overlay" id="mobileNavOverlay">
      <nav class="mobile-nav">
        <div class="mobile-nav-header">
          <span class="mobile-nav-title">{t['nav.title']}</span>
          <button class="mobile-nav-close" id="mobileNavClose">‚úï</button>
        </div>
        <ul class="mobile-nav-list">
        </ul>
        <div class="mobile-nav-footer">
          <button class="mobile-nav-btn" data-action="help">‚ùì {t['nav.help']}</button>
          <button class="mobile-nav-btn" data-action="settings">‚öôÔ∏è {t['nav.settings']}</button>
        </div>
      </nav>
    </div>

    <!-- Help Modal -->
    <div class="info-modal-overlay" id="helpModal">
      <div class="info-modal">
        <div class="info-modal-header">
          <div class="info-modal-icon help-icon">
            <svg viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/><path d="M9 9a3 3 0 115 2.83c-.5.29-1 .88-1 1.67v.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="12" cy="17" r="1" fill="currentColor"/></svg>
          </div>
          <div class="info-modal-title-group">
            <h3 class="info-modal-title">{t['help.title']}</h3>
            <p class="info-modal-subtitle">{t['help.subtitle']}</p>
          </div>
          <button class="info-modal-close" data-close-modal="helpModal" aria-label={t['help.close']}>
            <svg viewBox="0 0 24 24" fill="none"><path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </button>
        </div>
        <div class="info-modal-body">
          <div class="help-section">
            <h4 class="help-heading">‚öîÔ∏è {t['help.addEnemies.title']}</h4>
            <p set:html={t['help.addEnemies.text']} />
          </div>
          <div class="help-section">
            <h4 class="help-heading">üé≠ {t['help.types.title']}</h4>
            <ul class="help-list">
              <li><span class="help-tag normal">üë§ {t['type.normal']}</span> {t['help.types.normal']}</li>
              <li><span class="help-tag elite">‚≠ê {t['type.elite']}</span> {t['help.types.elite']}</li>
              <li><span class="help-tag boss">üëë {t['type.boss']}</span> {t['help.types.boss']}</li>
              <li><span class="help-tag objective">üéØ {t['type.objective']}</span> {t['help.types.objective']}</li>
            </ul>
          </div>
          <div class="help-section">
            <h4 class="help-heading">‚ù§Ô∏è {t['help.health.title']}</h4>
            <p set:html={t['help.health.text']} />
          </div>
          <div class="help-section">
            <h4 class="help-heading">üìã {t['help.statuses.title']}</h4>
            <ul class="help-list">
              <li><span class="help-emoji">‚ò†Ô∏è</span> <Fragment set:html={t['help.statuses.poison']} /></li>
              <li><span class="help-emoji">ü©∏</span> <Fragment set:html={t['help.statuses.wound']} /></li>
              <li><span class="help-emoji">‚õìÔ∏è</span> <Fragment set:html={t['help.statuses.immobilize']} /></li>
              <li><span class="help-emoji">üö´</span> <Fragment set:html={t['help.statuses.disarm']} /></li>
              <li><span class="help-emoji">üí´</span> <Fragment set:html={t['help.statuses.stun']} /></li>
              <li><span class="help-emoji">üåÄ</span> <Fragment set:html={t['help.statuses.muddle']} /></li>
              <li><span class="help-emoji">üí™</span> <Fragment set:html={t['help.statuses.strengthen']} /></li>
              <li><span class="help-emoji">üõ°Ô∏è</span> <Fragment set:html={t['help.statuses.shield']} /></li>
            </ul>
          </div>
          <div class="help-section">
            <h4 class="help-heading">üî¢ {t['help.numbering.title']}</h4>
            <p>{t['help.numbering.text']}</p>
          </div>
          <div class="help-section">
            <h4 class="help-heading">üéÆ {t['help.controls.title']}</h4>
            <ul class="help-list">
              <li><Fragment set:html={t['help.controls.collapse']} /></li>
              <li><Fragment set:html={t['help.controls.duplicate']} /></li>
              <li><Fragment set:html={t['help.controls.delete']} /></li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Settings Modal -->
    <div class="info-modal-overlay" id="settingsModal">
      <div class="info-modal">
        <div class="info-modal-header">
          <div class="info-modal-icon settings-icon">
            <svg viewBox="0 0 24 24" fill="none"><path d="M12 15a3 3 0 100-6 3 3 0 000 6z" stroke="currentColor" stroke-width="2"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z" stroke="currentColor" stroke-width="2"/></svg>
          </div>
          <div class="info-modal-title-group">
            <h3 class="info-modal-title">{t['settings.title']}</h3>
            <p class="info-modal-subtitle">{t['settings.subtitle']}</p>
          </div>
          <button class="info-modal-close" data-close-modal="settingsModal" aria-label={t['settings.close']}>
            <svg viewBox="0 0 24 24" fill="none"><path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          </button>
        </div>
        <div class="info-modal-body">
          <div class="setting-item">
            <div class="setting-info">
              <span class="setting-label">üé¨ {t['settings.animations.label']}</span>
              <span class="setting-desc">{t['settings.animations.desc']}</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="settingAnimations" checked />
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <span class="setting-label">‚ö†Ô∏è {t['settings.confirmClear.label']}</span>
              <span class="setting-desc">{t['settings.confirmClear.desc']}</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="settingConfirmClear" checked />
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <span class="setting-label">üíÄ {t['settings.autoRemove.label']}</span>
              <span class="setting-desc">{t['settings.autoRemove.desc']}</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="settingAutoRemoveDead" checked />
              <span class="toggle-slider"></span>
            </label>
          </div>
          <div class="setting-item">
            <div class="setting-info">
              <span class="setting-label">üìè {t['settings.compact.label']}</span>
              <span class="setting-desc">{t['settings.compact.desc']}</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="settingCompactCards" />
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <main class="main" id="enemigos">
      <div class="main-content container">
        <EnemyManager t={t} />
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-inner container">
        <p class="footer-copyright">¬© 2026 <a href="https://antoniopaya22.github.io" target="_blank" rel="noopener noreferrer" class="footer-link">Antonio Pay√° Gonz√°lez</a></p>
      </div>
    </footer>

    <!-- Decorative Bottom Border -->
    <div class="decorative-border bottom-border">
      <div class="border-ornament left"></div>
      <div class="border-line"></div>
      <div class="border-ornament right"></div>
    </div>
  </div>

  <!-- i18n data for client-side scripts -->
  <script type="application/json" id="i18n-data" set:html={JSON.stringify(jsTranslations)} />
</Layout>

<script>
  // Mobile Navigation
  const mobileMenuBtn = document.getElementById('mobileMenuBtn');
  const mobileNavOverlay = document.getElementById('mobileNavOverlay');
  const mobileNavClose = document.getElementById('mobileNavClose');

  function openMobileNav() {
    mobileNavOverlay?.classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeMobileNav() {
    mobileNavOverlay?.classList.remove('active');
    document.body.style.overflow = '';
  }

  mobileMenuBtn?.addEventListener('click', openMobileNav);
  mobileNavClose?.addEventListener('click', closeMobileNav);
  mobileNavOverlay?.addEventListener('click', (e) => {
    if (e.target === mobileNavOverlay) closeMobileNav();
  });

  // Close on escape
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeMobileNav();
  });

  // ==========================================
  // HELP & SETTINGS MODALS
  // ==========================================
  function openInfoModal(id: string) {
    const modal = document.getElementById(id);
    if (!modal) return;
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeInfoModal(id: string) {
    const modal = document.getElementById(id);
    if (!modal) return;
    modal.classList.remove('active');
    document.body.style.overflow = '';
  }

  // Desktop buttons
  document.getElementById('helpBtn')?.addEventListener('click', () => openInfoModal('helpModal'));
  document.getElementById('settingsBtn')?.addEventListener('click', () => openInfoModal('settingsModal'));

  // Mobile buttons
  document.querySelectorAll('.mobile-nav-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      closeMobileNav();
      const action = (btn as HTMLElement).dataset.action;
      if (action === 'help') openInfoModal('helpModal');
      if (action === 'settings') openInfoModal('settingsModal');
    });
  });

  // Close buttons inside modals
  document.querySelectorAll('[data-close-modal]').forEach(btn => {
    btn.addEventListener('click', () => {
      const modalId = (btn as HTMLElement).dataset.closeModal!;
      closeInfoModal(modalId);
    });
  });

  // Close on backdrop click
  document.querySelectorAll('.info-modal-overlay').forEach(overlay => {
    overlay.addEventListener('click', (e) => {
      if (e.target === overlay) closeInfoModal(overlay.id);
    });
  });

  // Close on Escape
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      document.querySelectorAll('.info-modal-overlay.active').forEach(m => {
        closeInfoModal(m.id);
      });
    }
  });

  // ==========================================
  // SETTINGS PERSISTENCE
  // ==========================================
  const SETTINGS_KEY = 'gh-settings';

  interface AppSettings {
    animations: boolean;
    confirmClear: boolean;
    autoRemoveDead: boolean;
    compactCards: boolean;
  }

  function loadSettings(): AppSettings {
    try {
      const raw = localStorage.getItem(SETTINGS_KEY);
      if (raw) return JSON.parse(raw);
    } catch {}
    return { animations: true, confirmClear: true, autoRemoveDead: true, compactCards: false };
  }

  function saveSettings(settings: AppSettings) {
    localStorage.setItem(SETTINGS_KEY, JSON.stringify(settings));
    applySettings(settings);
  }

  function applySettings(settings: AppSettings) {
    document.documentElement.dataset.animations = settings.animations ? 'on' : 'off';
    document.documentElement.dataset.autoRemoveDead = settings.autoRemoveDead ? 'on' : 'off';
    document.documentElement.dataset.confirmClear = settings.confirmClear ? 'on' : 'off';
    document.documentElement.dataset.compactCards = settings.compactCards ? 'on' : 'off';
  }

  // Initialize settings
  const settings = loadSettings();
  (document.getElementById('settingAnimations') as HTMLInputElement).checked = settings.animations;
  (document.getElementById('settingConfirmClear') as HTMLInputElement).checked = settings.confirmClear;
  (document.getElementById('settingAutoRemoveDead') as HTMLInputElement).checked = settings.autoRemoveDead;
  (document.getElementById('settingCompactCards') as HTMLInputElement).checked = settings.compactCards;
  applySettings(settings);

  // Listen for changes
  const settingInputs: { id: string; key: keyof AppSettings }[] = [
    { id: 'settingAnimations', key: 'animations' },
    { id: 'settingConfirmClear', key: 'confirmClear' },
    { id: 'settingAutoRemoveDead', key: 'autoRemoveDead' },
    { id: 'settingCompactCards', key: 'compactCards' },
  ];

  settingInputs.forEach(({ id, key }) => {
    document.getElementById(id)?.addEventListener('change', (e) => {
      const s = loadSettings();
      s[key] = (e.target as HTMLInputElement).checked;
      saveSettings(s);
    });
  });
</script>

<style>
  /* ==========================================
     APP LAYOUT
     ========================================== */
  .app-layout {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    min-height: 100dvh;
  }

  /* ==========================================
     DECORATIVE BORDERS
     ========================================== */
  .decorative-border {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-1) var(--space-3);
    background: linear-gradient(90deg,
      transparent 0%,
      rgba(184, 134, 42, 0.1) 20%,
      rgba(184, 134, 42, 0.15) 50%,
      rgba(184, 134, 42, 0.1) 80%,
      transparent 100%
    );
  }

  .border-line {
    flex: 1;
    height: 1px;
    background: linear-gradient(90deg,
      transparent 0%,
      var(--gh-gold-600) 20%,
      var(--gh-gold-400) 50%,
      var(--gh-gold-600) 80%,
      transparent 100%
    );
  }

  .border-ornament {
    width: 5px;
    height: 5px;
    background: var(--gh-gold-500);
    transform: rotate(45deg);
    box-shadow: 0 0 8px rgba(184, 134, 42, 0.5);
  }

  .bottom-border {
    margin-top: auto;
  }

  /* ==========================================
     HEADER
     ========================================== */
  .header {
    position: sticky;
    top: 0;
    z-index: var(--z-sticky);
    background: linear-gradient(180deg,
      rgba(26, 20, 16, 0.98) 0%,
      rgba(26, 20, 16, 0.95) 100%
    );
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--gh-border-default);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
  }

  .header-inner {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-3);
    padding-block: var(--space-2);
    position: relative;
  }

  /* Brand */
  .brand {
    display: flex;
    align-items: center;
    gap: var(--space-3);
  }

  /* Header Actions */
  .header-actions {
    position: absolute;
    right: var(--space-4);
    display: none;
    align-items: center;
    gap: var(--space-2);
  }

  .brand-emblem {
    position: relative;
    width: 38px;
    height: 38px;
    flex-shrink: 0;
  }

  .emblem-inner {
    position: relative;
    z-index: 2;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(145deg, var(--gh-bg-medium) 0%, var(--gh-bg-dark) 100%);
    border: 2px solid var(--gh-gold-600);
    border-radius: var(--radius-lg);
    box-shadow:
      inset 0 2px 4px rgba(255, 255, 255, 0.1),
      inset 0 -2px 4px rgba(0, 0, 0, 0.3),
      0 4px 12px rgba(0, 0, 0, 0.5);
  }

  .emblem-icon {
    width: 22px;
    height: 22px;
  }

  .emblem-glow {
    position: absolute;
    inset: -4px;
    background: radial-gradient(circle, rgba(184, 134, 42, 0.3) 0%, transparent 70%);
    border-radius: var(--radius-xl);
    z-index: 1;
    animation: pulse 3s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.05); }
  }

  .brand-text {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: var(--space-1);
  }

  .brand-title {
    font-family: var(--font-display);
    font-size: var(--text-xl);
    font-weight: 700;
    background: linear-gradient(135deg,
      var(--gh-gold-200) 0%,
      var(--gh-gold-400) 30%,
      var(--gh-gold-300) 50%,
      var(--gh-gold-500) 70%,
      var(--gh-gold-300) 100%
    );
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-shadow: 0 2px 10px rgba(184, 134, 42, 0.3);
    letter-spacing: 0.08em;
    margin: 0;
    line-height: 1;
  }

  .brand-divider {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    width: 100%;
  }

  .divider-line {
    flex: 1;
    height: 1px;
    background: linear-gradient(90deg, var(--gh-gold-600), transparent);
  }

  .divider-gem {
    color: var(--gh-gold-500);
    font-size: 6px;
  }

  .brand-tagline {
    font-family: var(--font-heading);
    font-size: var(--text-xs);
    color: var(--gh-text-muted);
    text-transform: uppercase;
    letter-spacing: 0.2em;
    margin: 0;
  }

  @media (min-width: 900px) {
    .header-actions {
      display: flex;
    }
  }

  .action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    background: var(--gh-bg-medium);
    border: 1px solid var(--gh-border-default);
    border-radius: var(--radius-md);
    color: var(--gh-text-secondary);
    cursor: pointer;
    transition: all var(--transition-base);
  }

  .action-btn:hover {
    background: var(--gh-bg-light);
    border-color: var(--gh-gold-600);
    color: var(--gh-gold-400);
    box-shadow: 0 0 15px rgba(184, 134, 42, 0.2);
  }

  .action-btn svg {
    width: 16px;
    height: 16px;
  }

  /* Mobile Menu Button */
  .mobile-menu-btn {
    position: absolute;
    right: var(--space-4);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 4px;
    width: 32px;
    height: 32px;
    background: var(--gh-bg-medium);
    border: 1px solid var(--gh-border-default);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-base);
  }

  @media (min-width: 900px) {
    .mobile-menu-btn {
      display: none;
    }
  }

  .mobile-menu-btn:hover {
    background: var(--gh-bg-light);
    border-color: var(--gh-gold-600);
  }

  .hamburger-line {
    width: 16px;
    height: 1.5px;
    background: var(--gh-gold-500);
    border-radius: 1px;
    transition: all var(--transition-base);
  }

  /* Mobile Navigation */
  .mobile-nav-overlay {
    position: fixed;
    inset: 0;
    z-index: var(--z-modal);
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(4px);
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-base);
  }

  .mobile-nav-overlay.active {
    opacity: 1;
    visibility: visible;
  }

  .mobile-nav {
    position: absolute;
    top: 0;
    right: 0;
    width: min(320px, 85vw);
    height: 100%;
    background: linear-gradient(180deg, var(--gh-bg-dark) 0%, var(--gh-bg-darker) 100%);
    border-left: 1px solid var(--gh-border-default);
    transform: translateX(100%);
    transition: transform var(--transition-slow);
    display: flex;
    flex-direction: column;
  }

  .mobile-nav-overlay.active .mobile-nav {
    transform: translateX(0);
  }

  .mobile-nav-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--space-4);
    border-bottom: 1px solid var(--gh-border-default);
  }

  .mobile-nav-title {
    font-family: var(--font-heading);
    font-size: var(--text-lg);
    color: var(--gh-gold-400);
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }

  .mobile-nav-close {
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--gh-bg-medium);
    border: 1px solid var(--gh-border-default);
    border-radius: var(--radius-md);
    color: var(--gh-text-secondary);
    font-size: var(--text-lg);
    cursor: pointer;
    transition: all var(--transition-fast);
  }

  .mobile-nav-close:hover {
    background: var(--gh-red-700);
    border-color: var(--gh-red-600);
    color: white;
  }

  .mobile-nav-list {
    list-style: none;
    padding: var(--space-4);
    margin: 0;
    flex: 1;
  }

  .mobile-nav-link {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-4);
    color: var(--gh-text-secondary);
    font-family: var(--font-heading);
    font-size: var(--text-base);
    text-decoration: none;
    border-radius: var(--radius-md);
    border: 1px solid transparent;
    margin-bottom: var(--space-2);
    transition: all var(--transition-base);
  }

  .mobile-nav-link:hover,
  .mobile-nav-link.active {
    color: var(--gh-gold-400);
    background: rgba(184, 134, 42, 0.1);
    border-color: var(--gh-border-default);
  }

  .mobile-nav-footer {
    padding: var(--space-4);
    border-top: 1px solid var(--gh-border-default);
    display: flex;
    gap: var(--space-2);
  }

  .mobile-nav-btn {
    flex: 1;
    padding: var(--space-3);
    background: var(--gh-bg-medium);
    border: 1px solid var(--gh-border-default);
    border-radius: var(--radius-md);
    color: var(--gh-text-secondary);
    font-family: var(--font-heading);
    font-size: var(--text-sm);
    cursor: pointer;
    transition: all var(--transition-base);
  }

  .mobile-nav-btn:hover {
    background: var(--gh-bg-light);
    color: var(--gh-text-primary);
  }

  /* ==========================================
     MAIN CONTENT
     ========================================== */
  .main {
    flex: 1;
    padding-block: var(--space-4);
  }

  @media (min-width: 768px) {
    .main {
      padding-block: var(--space-5);
    }
  }

  .main-content {
    display: flex;
    flex-direction: column;
  }

  /* ==========================================
     FOOTER
     ========================================== */
  .footer {
    border-top: 1px solid var(--gh-border-subtle);
    padding-block: var(--space-3);
  }

  .footer-inner {
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
  }

  .footer-copyright {
    font-size: var(--text-xs);
    color: var(--gh-text-muted);
    margin: 0;
  }

  .footer-link {
    color: var(--gh-gold-500);
    transition: color var(--transition-fast);
  }

  .footer-link:hover {
    color: var(--gh-gold-300);
  }

  /* ==========================================
     RESPONSIVE ADJUSTMENTS
     ========================================== */
  @media (max-width: 640px) {
    .brand-emblem {
      width: 32px;
      height: 32px;
    }

    .emblem-icon {
      width: 18px;
      height: 18px;
    }

    .brand-title {
      font-size: var(--text-lg);
    }

    .brand-divider,
    .brand-tagline {
      display: none;
    }

    .decorative-border {
      padding: var(--space-1) var(--space-2);
    }

    .border-ornament {
      width: 4px;
      height: 4px;
    }
  }

  @media (max-width: 400px) {
    .brand-title {
      font-size: var(--text-base);
    }

    .brand-emblem {
      width: 28px;
      height: 28px;
    }

    .emblem-icon {
      width: 16px;
      height: 16px;
    }
  }

  /* ==========================================
     INFO MODALS (Help & Settings)
     ========================================== */
  .info-modal-overlay {
    position: fixed;
    inset: 0;
    z-index: var(--z-modal);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-4);
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(8px);
    opacity: 0;
    visibility: hidden;
    transition: all var(--transition-base);
  }

  .info-modal-overlay.active {
    opacity: 1;
    visibility: visible;
  }

  .info-modal {
    width: 100%;
    max-width: 480px;
    max-height: 85vh;
    overflow-y: auto;
    background: linear-gradient(180deg, var(--gh-bg-medium) 0%, var(--gh-bg-dark) 100%);
    border: 1px solid var(--gh-border-default);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-xl), 0 0 40px rgba(184, 134, 42, 0.1);
    transform: scale(0.9) translateY(20px);
    transition: transform var(--transition-slow);
  }

  .info-modal-overlay.active .info-modal {
    transform: scale(1) translateY(0);
  }

  .info-modal-header {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
    padding: var(--space-4);
    border-bottom: 1px solid var(--gh-border-subtle);
    background: linear-gradient(180deg, rgba(184, 134, 42, 0.05) 0%, transparent 100%);
  }

  .info-modal-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: var(--radius-md);
    color: var(--gh-text-dark);
    flex-shrink: 0;
  }

  .info-modal-icon svg {
    width: 18px;
    height: 18px;
  }

  .help-icon {
    background: linear-gradient(135deg, var(--gh-blue-500) 0%, var(--gh-blue-700) 100%);
  }

  .settings-icon {
    background: linear-gradient(135deg, var(--gh-gold-600) 0%, var(--gh-gold-700) 100%);
  }

  .info-modal-title-group {
    flex: 1;
  }

  .info-modal-title {
    font-family: var(--font-heading);
    font-size: var(--text-lg);
    color: var(--gh-text-primary);
    margin: 0 0 var(--space-1) 0;
  }

  .info-modal-subtitle {
    font-size: var(--text-sm);
    color: var(--gh-text-muted);
    margin: 0;
  }

  .info-modal-close {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
    background: var(--gh-bg-light);
    border: 1px solid var(--gh-border-default);
    border-radius: var(--radius-md);
    color: var(--gh-text-muted);
    cursor: pointer;
    transition: all var(--transition-fast);
  }

  .info-modal-close:hover {
    background: var(--gh-red-700);
    border-color: var(--gh-red-600);
    color: white;
  }

  .info-modal-close svg {
    width: 16px;
    height: 16px;
  }

  .info-modal-body {
    padding: var(--space-4);
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
  }

  /* Help Content */
  .help-section {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .help-heading {
    font-family: var(--font-heading);
    font-size: var(--text-base);
    color: var(--gh-gold-400);
    margin: 0;
    padding-bottom: var(--space-2);
    border-bottom: 1px solid var(--gh-border-subtle);
  }

  .help-section p {
    font-size: var(--text-sm);
    color: var(--gh-text-secondary);
    line-height: var(--leading-relaxed);
    margin: 0;
  }

  .help-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .help-list li {
    font-size: var(--text-sm);
    color: var(--gh-text-secondary);
    display: flex;
    align-items: center;
    gap: var(--space-2);
    line-height: var(--leading-relaxed);
  }

  .help-tag {
    display: inline-flex;
    align-items: center;
    gap: var(--space-1);
    padding: 2px var(--space-2);
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
    font-weight: 600;
    white-space: nowrap;
    flex-shrink: 0;
  }

  .help-tag.normal {
    background: rgba(144, 97, 228, 0.15);
    color: var(--gh-purple-400);
  }

  .help-tag.elite {
    background: rgba(184, 134, 42, 0.15);
    color: var(--gh-gold-400);
  }

  .help-tag.boss {
    background: rgba(220, 69, 69, 0.15);
    color: var(--gh-red-400);
  }

  .help-tag.objective {
    background: rgba(109, 184, 232, 0.15);
    color: var(--gh-blue-400);
  }

  .help-emoji {
    font-size: var(--text-base);
    flex-shrink: 0;
    width: 24px;
    text-align: center;
  }

  .text-red {
    color: var(--gh-red-400);
  }

  .text-green {
    color: var(--gh-green-400);
  }

  /* Settings Content */
  .setting-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-3);
    padding: var(--space-3);
    background: var(--gh-bg-dark);
    border: 1px solid var(--gh-border-subtle);
    border-radius: var(--radius-md);
    transition: border-color var(--transition-fast);
  }

  .setting-item:hover {
    border-color: var(--gh-border-default);
  }

  .setting-info {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
  }

  .setting-label {
    font-family: var(--font-heading);
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--gh-text-primary);
  }

  .setting-desc {
    font-size: var(--text-xs);
    color: var(--gh-text-muted);
    line-height: var(--leading-relaxed);
  }

  /* Toggle switch */
  .toggle {
    position: relative;
    display: inline-block;
    width: 40px;
    height: 22px;
    flex-shrink: 0;
    cursor: pointer;
  }

  .toggle input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .toggle-slider {
    position: absolute;
    inset: 0;
    background: var(--gh-bg-lighter);
    border: 2px solid var(--gh-border-default);
    border-radius: 22px;
    transition: all var(--transition-base);
  }

  .toggle-slider::before {
    content: '';
    position: absolute;
    height: 14px;
    width: 14px;
    left: 2px;
    bottom: 2px;
    background: var(--gh-text-muted);
    border-radius: 50%;
    transition: all var(--transition-base);
  }

  .toggle input:checked + .toggle-slider {
    background: rgba(184, 134, 42, 0.2);
    border-color: var(--gh-gold-500);
  }

  .toggle input:checked + .toggle-slider::before {
    transform: translateX(18px);
    background: var(--gh-gold-400);
  }

  .toggle input:focus-visible + .toggle-slider {
    box-shadow: 0 0 0 3px rgba(184, 134, 42, 0.3);
  }

  /* Landscape small devices */
  @media (max-height: 500px) and (orientation: landscape) {
    .header-inner {
      padding-block: var(--space-2);
    }

    .brand-emblem {
      width: 40px;
      height: 40px;
    }

    .decorative-border {
      display: none;
    }

    .main {
      padding-block: var(--space-4);
    }

    .footer {
      padding-block: var(--space-2);
    }
  }
</style>
